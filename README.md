# Voosh RAG Chatbot

A minimal news Q&A app that ingests RSS articles, stores chunk embeddings in **Qdrant**, and answers user questions with **Gemini** grounded to retrieved passages. Per-session chat history is kept in **Redis** (Upstash REST) or an in-memory fallback.

## âœ¨ Features
- RAG pipeline: RSS â†’ fetch â†’ split â†’ **Jina embeddings** â†’ **Qdrant** (vector DB)
- Express backend: `/api/session/new`, `/api/chat`, `/api/history/:id`, `/api/reset/:id`, `/api/stats`
- React + SCSS frontend: chat bubbles, citations, typing dots, reset, responsive layout
- Environment-driven config with `.env` and shareable `.env.example`
- Works with Upstash REST Redis (or local memory if not configured)

---

## ğŸ§± Stack
- **Backend:** Node 18+, Express, Axios, Qdrant HTTP, Jina embeddings API, Google Gemini
- **Frontend:** React + Vite + SCSS
- **Vector DB:** Qdrant Cloud (HTTP)
- **Cache/History:** Upstash Redis REST (optional)

---

## ğŸ“ Repo Structure
voosh-rag-backend/
â”œâ”€ src/server.js
â”œâ”€ ingest/
â”‚ â”œâ”€ fetch_seeds.py # RSS â†’ seed_urls.txt
â”‚ â”œâ”€ ingest.py # fetch â†’ split â†’ embed â†’ upsert (Qdrant)
â”‚ â””â”€ requirements.txt
â”œâ”€ seed_urls.txt # generated by fetch_seeds.py
â”œâ”€ .env # (not committed)
â”œâ”€ .env.example # sample env (commit this)
â””â”€ package.json

voosh-rag-frontend/
â”œâ”€ src/App.jsx
â”œâ”€ src/styles/app.scss
â”œâ”€ index.html
â”œâ”€ .env # (not committed)
â”œâ”€ .env.example # sample env (commit this)
â””â”€ package.json

Frontend â€” voosh-rag-frontend/.env.example
VITE_API_URL=http://localhost:8080


In src/App.jsx this is read as:

const API_BASE = import.meta.env.VITE_API_URL || "http://localhost:8080";

ğŸ“¥ Ingest: put news into Qdrant

From voosh-rag-backend/:

# 1) Python deps
pip install -r ingest/requirements.txt

# 2) RSS â†’ seed_urls.txt
npm run seeds
# or: python ingest/fetch_seeds.py

# 3) ingest URLs â†’ Qdrant (split, embed, upsert)
npm run ingest
# or: python ingest/ingest.py


Verify:

curl http://localhost:8080/api/stats
# â†’ { "docs": 229, "lastIngestAt": "2025-09-17T20:13:12.050461+00:00" }

â–¶ï¸ Run locally

Terminal A â€” backend

cd voosh-rag-backend
npm install
npm run dev
# http://localhost:8080


Terminal B â€” frontend

cd voosh-rag-frontend
npm install
npm run dev
# http://localhost:5173


Open the app and try queries like: bbc, mining in zambia, tottenham.

ğŸ§ª API quick reference

GET /health â†’ { ok: true }

GET /api/stats â†’ { docs, lastIngestAt }

POST /api/session/new â†’ { sessionId }

GET /api/history/:id â†’ { messages: [...] }

POST /api/reset/:id â†’ { ok: true }

POST /api/chat
Request

{ "sessionId": "<uuid>", "message": "bbc" }


Response

{
  "answer": "The BBC is mentioned... [S1] [S2] ...",
  "sources": [
    { "id": 1, "title": "Eritrean man wins...", "url": "https://..." },
    { "id": 2, "title": "US officers tied...", "url": "https://..." }
  ]
}

ğŸ§° Scripts

Backend package.json:

dev â€“ start Express API

seeds â€“ run ingest/fetch_seeds.py

ingest â€“ run ingest/ingest.py

Frontend package.json:

dev â€“ Vite dev server

ğŸ“ Notes

Answers are grounded to retrieved passages. If no match meets MIN_SCORE, the server either returns â€œUnsureâ€ + links, or (if enabled) an off-corpus Gemini answer labelled accordingly.

Per-session chat history uses Upstash Redis when configured; otherwise an in-memory demo fallback.

Ingest uses stable chunk IDs (URL + chunk index) to avoid duplicate upserts on re-ingest.

Frontend is responsive, SCSS styled, and shows click-through citations.

ğŸ§¯ Troubleshooting

503 The model is overloaded. Please try again later.
Gemini capacity hiccupâ€”retry shortly (you can configure small retry/backoff via LLM_RETRIES/LLM_RETRY_MS).

CORS
Ensure backend ORIGIN=http://localhost:5173 and restart.

Qdrant auth
Double-check QDRANT_URL (HTTP endpoint) and QDRANT_API_KEY.

Empty results
Run npm run seeds then npm run ingest. Check GET /api/stats.

Redis not set
Falls back to in-memory. For persistence, set:

UPSTASH_REDIS_REST_URL
UPSTASH_REDIS_REST_TOKEN

ğŸ”’ .gitignore (put at repo root)
# env
.env
voosh-rag-backend/.env
voosh-rag-frontend/.env

# deps / build
node_modules/
dist/
.vite/

# logs
npm-debug.log*
yarn-debug.log*
pnpm-debug.log*

# editors/OS
.vscode/
.idea/
.DS_Store
Thumbs.db
